<template>
  <div class="flex flex-col gap-2.5 select-none">
    <!-- Modal exit controls -->

    <!-- Modal -->
    <div v-if="modal" class="flex flex-col-reverse gap-2.5">
      <div
        class="flex gap-2.5 flex-row items-center text-base text-text-secondary font-medium"
      >
        <span>{{ formattedDate }}</span>
        <span class="text-sm">•</span>
        <div class="flex flex-row gap-1">
          <svg
            width="20"
            height="20"
            viewBox="0 0 20 20"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              d="M10.043 4.04199C8.6585 4.04199 7.30512 4.45253 6.15398 5.2217C5.00284 5.99087 4.10563 7.08412 3.57582 8.36321C3.046 9.64229 2.90738 11.0498 3.17747 12.4076C3.44757 13.7655 4.11426 15.0128 5.09322 15.9917C6.07219 16.9707 7.31947 17.6374 8.67734 17.9075C10.0352 18.1776 11.4427 18.039 12.7218 17.5091C14.0008 16.9793 15.0941 16.0821 15.8633 14.931C16.6324 13.7798 17.043 12.4265 17.043 11.042C17.043 9.18548 16.3055 7.405 14.9927 6.09224C13.68 4.77949 11.8995 4.04199 10.043 4.04199V4.04199ZM10.043 17.0652C8.84855 17.0652 7.68099 16.7109 6.68804 16.047C5.6951 15.3832 4.92143 14.4397 4.46494 13.3359C4.00846 12.2322 3.88968 11.0178 4.12365 9.84655C4.35762 8.67527 4.93381 7.59974 5.7793 6.75607C6.6248 5.9124 7.70157 5.33853 8.87335 5.10709C10.0451 4.87565 11.2592 4.99705 12.362 5.45592C13.4647 5.91479 14.4066 6.6905 15.0683 7.68487C15.73 8.67925 16.0818 9.84758 16.0792 11.042C16.0775 12.6424 15.441 14.1767 14.3094 15.3084C13.1777 16.44 11.6434 17.0765 10.043 17.0783V17.0652ZM13.2988 11.042C13.2988 11.1698 13.248 11.2924 13.1576 11.3827C13.0673 11.4731 12.9447 11.5239 12.8169 11.5239H10.043C9.91517 11.5239 9.79261 11.4731 9.70224 11.3827C9.61188 11.2924 9.56111 11.1698 9.56111 11.042V7.08292C9.56111 6.95512 9.61188 6.83256 9.70224 6.74219C9.79261 6.65183 9.91517 6.60106 10.043 6.60106C10.1708 6.60106 10.2933 6.65183 10.3837 6.74219C10.4741 6.83256 10.5248 6.95512 10.5248 7.08292V10.5601H12.8365C12.9608 10.5652 13.0784 10.6182 13.1646 10.708C13.2508 10.7978 13.2989 10.9175 13.2988 11.042V11.042Z"
              fill="#7E8299"
              stroke="#7E8299"
              stroke-width="0.5"
              stroke-linejoin="round"
            />
          </svg>
          <span>{{ props.post.readingTime }} мин</span>
        </div>
        <span class="text-sm">•</span>
        <div class="flex flex-row gap-1">
          <svg
            width="20"
            height="20"
            viewBox="0 0 20 20"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              d="M14.45 13.7333V8.23333C14.4478 7.53782 14.1705 6.87141 13.6787 6.37961C13.1869 5.8878 12.5205 5.61053 11.825 5.60833H4.32501V4.9C4.32499 3.8766 4.72981 2.89475 5.45112 2.16876C6.17242 1.44277 7.15163 1.0316 8.17501 1.025H15.0417C16.0694 1.025 17.055 1.43326 17.7817 2.15996C18.5084 2.88667 18.9167 3.87229 18.9167 4.9V9.9C18.9145 10.9191 18.511 11.8963 17.7936 12.62C17.0761 13.3438 16.1024 13.7557 15.0833 13.7667L14.45 13.7333ZM11.825 4.35833C12.8527 4.35833 13.8383 4.76659 14.565 5.4933C15.2918 6.22 15.7 7.20562 15.7 8.23333V12.4C16.2563 12.256 16.7499 11.9334 17.1051 11.4818C17.4604 11.0302 17.6577 10.4745 17.6667 9.9V4.9C17.6645 4.20448 17.3872 3.53808 16.8954 3.04627C16.4036 2.55447 15.7372 2.2772 15.0417 2.275H8.17501C7.57162 2.27426 6.98652 2.48208 6.51878 2.86325C6.05104 3.24443 5.72941 3.77555 5.60834 4.36667L11.825 4.35833ZM8.39168 18.975C8.11942 18.9763 7.85098 18.911 7.60983 18.7846C7.36868 18.6582 7.16217 18.4746 7.00834 18.25L6.25834 17.1917C6.23236 17.1517 6.19642 17.1191 6.15405 17.0972C6.11168 17.0753 6.06434 17.0648 6.01668 17.0667H5.00001C4.48764 17.0722 3.97927 16.976 3.50431 16.7837C3.02936 16.5915 2.59725 16.3069 2.233 15.9465C1.86874 15.5862 1.57958 15.1571 1.38224 14.6843C1.18491 14.2114 1.08331 13.7041 1.08334 13.1917V8.23333C1.08331 7.72094 1.18491 7.21362 1.38224 6.74075C1.57958 6.26788 1.86874 5.83884 2.233 5.47846C2.59725 5.11808 3.02936 4.83352 3.50431 4.64126C3.97927 4.44899 4.48764 4.35283 5.00001 4.35833H11.8667C12.8944 4.35833 13.88 4.76659 14.6067 5.4933C15.3334 6.22 15.7417 7.20562 15.7417 8.23333V13.1917C15.7417 14.2194 15.3334 15.205 14.6067 15.9317C13.88 16.6584 12.8944 17.0667 11.8667 17.0667H10.7667C10.7191 17.0656 10.6721 17.0764 10.6299 17.0983C10.5876 17.1201 10.5516 17.1522 10.525 17.1917L9.77501 18.25C9.62119 18.4746 9.41467 18.6582 9.17352 18.7846C8.93237 18.911 8.66393 18.9763 8.39168 18.975V18.975ZM5.00001 5.60833C4.6521 5.60393 4.30677 5.66851 3.98397 5.79835C3.66116 5.9282 3.36729 6.12072 3.11934 6.36481C2.87138 6.60889 2.67425 6.89969 2.53934 7.22041C2.40443 7.54113 2.33442 7.8854 2.33334 8.23333V13.1917C2.33108 13.5413 2.39869 13.8879 2.53222 14.2111C2.66574 14.5342 2.86249 14.8275 3.1109 15.0735C3.35931 15.3196 3.65438 15.5136 3.97878 15.6441C4.30319 15.7745 4.65039 15.8389 5.00001 15.8333H6.01668C6.26537 15.8321 6.51063 15.8914 6.7313 16.0061C6.95197 16.1208 7.14143 16.2874 7.28334 16.4917L8.02501 17.5C8.06634 17.559 8.12121 17.6071 8.18501 17.6405C8.24881 17.6738 8.31968 17.6914 8.39168 17.6917V17.6917C8.46367 17.6914 8.53454 17.6738 8.59834 17.6405C8.66215 17.6071 8.71701 17.559 8.75834 17.5L9.50001 16.4417C9.64737 16.2466 9.83922 16.0897 10.0596 15.9839C10.2799 15.878 10.5223 15.8264 10.7667 15.8333H11.825C12.5212 15.8333 13.1889 15.5568 13.6812 15.0645C14.1734 14.5722 14.45 13.9045 14.45 13.2083V8.23333C14.4478 7.53782 14.1705 6.87141 13.6787 6.37961C13.1869 5.8878 12.5205 5.61053 11.825 5.60833H5.00001ZM5.48334 10C5.32841 10 5.17697 10.0459 5.04815 10.132C4.91933 10.2181 4.81893 10.3404 4.75964 10.4836C4.70035 10.6267 4.68484 10.7842 4.71506 10.9362C4.74529 11.0881 4.81989 11.2277 4.92944 11.3372C5.03899 11.4468 5.17857 11.5214 5.33052 11.5516C5.48247 11.5818 5.63998 11.5663 5.78311 11.507C5.92625 11.4478 6.04859 11.3474 6.13466 11.2185C6.22074 11.0897 6.26668 10.9383 6.26668 10.7833C6.26451 10.5763 6.18128 10.3783 6.03485 10.2318C5.88841 10.0854 5.69042 10.0022 5.48334 10ZM8.40001 10C8.2466 9.99705 8.09571 10.0392 7.96606 10.1213C7.83641 10.2033 7.7337 10.3216 7.6707 10.4615C7.6077 10.6014 7.58717 10.7568 7.61166 10.9082C7.63615 11.0597 7.70459 11.2006 7.80847 11.3136C7.91235 11.4265 8.04711 11.5064 8.19601 11.5434C8.34492 11.5804 8.50141 11.5729 8.64607 11.5217C8.79073 11.4706 8.91718 11.3781 9.00973 11.2557C9.10228 11.1333 9.15685 10.9865 9.16668 10.8333C9.17228 10.728 9.15677 10.6226 9.12106 10.5233C9.08535 10.4241 9.03016 10.3329 8.95874 10.2553C8.88731 10.1777 8.8011 10.1151 8.70515 10.0713C8.6092 10.0274 8.50545 10.0032 8.40001 10V10ZM11.3083 10C11.1534 10 11.002 10.0459 10.8731 10.132C10.7443 10.2181 10.6439 10.3404 10.5846 10.4836C10.5253 10.6267 10.5098 10.7842 10.5401 10.9362C10.5703 11.0881 10.6449 11.2277 10.7544 11.3372C10.864 11.4468 11.0036 11.5214 11.1555 11.5516C11.3075 11.5818 11.465 11.5663 11.6081 11.507C11.7512 11.4478 11.8736 11.3474 11.9597 11.2185C12.0457 11.0897 12.0917 10.9383 12.0917 10.7833C12.0895 10.5763 12.0063 10.3783 11.8598 10.2318C11.7134 10.0854 11.5154 10.0022 11.3083 10V10Z"
              fill="#7E8299"
            />
          </svg>
          <span>{{ commentsAmount }}</span>
        </div>
      </div>
      <div class="flex flex-row justify-between">
        <h2 class="text-2xl font-semibold leading-none">
          {{ props.post.title }}
        </h2>
        <svg
          @click="handleExitClick"
          class="cursor-pointer"
          width="20"
          height="20"
          viewBox="0 0 20 20"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            d="M11.175 10L14.1667 7.03333C14.3258 6.87199 14.4143 6.65404 14.4127 6.42744C14.4112 6.20083 14.3197 5.98413 14.1583 5.825C13.997 5.66587 13.779 5.57735 13.5524 5.57891C13.3258 5.58047 13.1091 5.67199 12.95 5.83333V5.83333L9.99999 8.825L7.04999 5.89166C6.89386 5.73645 6.68265 5.64934 6.46249 5.64934C6.24234 5.64934 6.03113 5.73645 5.87499 5.89166C5.79689 5.96913 5.73489 6.0613 5.69258 6.16285C5.65028 6.2644 5.6285 6.37332 5.6285 6.48333C5.6285 6.59334 5.65028 6.70226 5.69258 6.80381C5.73489 6.90536 5.79689 6.99753 5.87499 7.075L8.82499 10L5.83333 12.9667C5.6742 13.128 5.58568 13.3459 5.58724 13.5726C5.5888 13.7992 5.68032 14.0159 5.84166 14.175C6.003 14.3341 6.22095 14.4226 6.44755 14.4211C6.67416 14.4195 6.89086 14.328 7.04999 14.1667L9.99999 11.175L12.95 14.1083C13.1061 14.2635 13.3173 14.3507 13.5375 14.3507C13.7576 14.3507 13.9689 14.2635 14.125 14.1083C14.2031 14.0309 14.2651 13.9387 14.3074 13.8371C14.3497 13.7356 14.3715 13.6267 14.3715 13.5167C14.3715 13.4067 14.3497 13.2977 14.3074 13.1962C14.2651 13.0946 14.2031 13.0025 14.125 12.925L11.175 10Z"
            fill="#A1A5B7"
          />
        </svg>
      </div>
    </div>
    <img
      :class="`h-60 object-cover rounded-xl ${
        clickable ? 'cursor-pointer ' : ' '
      } ${modal ? 'max-h-96 h-3/6' : ' '}`"
      :src="props.post.imageUrl"
      alt="Post image"
      @click="handleImageClick"
    />

    <!-- Non-modal -->

    <div v-if="!modal" class="flex flex-col gap-2.5">
      <div
        class="flex gap-2.5 flex-row items-center text-base text-text-secondary font-medium"
      >
        <span>{{ formattedDate }}</span>
        <span class="text-sm">•</span>
        <div class="flex flex-row gap-1">
          <svg
            width="20"
            height="20"
            viewBox="0 0 20 20"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              d="M10.043 4.04199C8.6585 4.04199 7.30512 4.45253 6.15398 5.2217C5.00284 5.99087 4.10563 7.08412 3.57582 8.36321C3.046 9.64229 2.90738 11.0498 3.17747 12.4076C3.44757 13.7655 4.11426 15.0128 5.09322 15.9917C6.07219 16.9707 7.31947 17.6374 8.67734 17.9075C10.0352 18.1776 11.4427 18.039 12.7218 17.5091C14.0008 16.9793 15.0941 16.0821 15.8633 14.931C16.6324 13.7798 17.043 12.4265 17.043 11.042C17.043 9.18548 16.3055 7.405 14.9927 6.09224C13.68 4.77949 11.8995 4.04199 10.043 4.04199V4.04199ZM10.043 17.0652C8.84855 17.0652 7.68099 16.7109 6.68804 16.047C5.6951 15.3832 4.92143 14.4397 4.46494 13.3359C4.00846 12.2322 3.88968 11.0178 4.12365 9.84655C4.35762 8.67527 4.93381 7.59974 5.7793 6.75607C6.6248 5.9124 7.70157 5.33853 8.87335 5.10709C10.0451 4.87565 11.2592 4.99705 12.362 5.45592C13.4647 5.91479 14.4066 6.6905 15.0683 7.68487C15.73 8.67925 16.0818 9.84758 16.0792 11.042C16.0775 12.6424 15.441 14.1767 14.3094 15.3084C13.1777 16.44 11.6434 17.0765 10.043 17.0783V17.0652ZM13.2988 11.042C13.2988 11.1698 13.248 11.2924 13.1576 11.3827C13.0673 11.4731 12.9447 11.5239 12.8169 11.5239H10.043C9.91517 11.5239 9.79261 11.4731 9.70224 11.3827C9.61188 11.2924 9.56111 11.1698 9.56111 11.042V7.08292C9.56111 6.95512 9.61188 6.83256 9.70224 6.74219C9.79261 6.65183 9.91517 6.60106 10.043 6.60106C10.1708 6.60106 10.2933 6.65183 10.3837 6.74219C10.4741 6.83256 10.5248 6.95512 10.5248 7.08292V10.5601H12.8365C12.9608 10.5652 13.0784 10.6182 13.1646 10.708C13.2508 10.7978 13.2989 10.9175 13.2988 11.042V11.042Z"
              fill="#7E8299"
              stroke="#7E8299"
              stroke-width="0.5"
              stroke-linejoin="round"
            />
          </svg>
          <span>{{ props.post.readingTime }} мин</span>
        </div>
        <span class="text-sm">•</span>
        <div class="flex flex-row gap-1">
          <svg
            width="20"
            height="20"
            viewBox="0 0 20 20"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              d="M14.45 13.7333V8.23333C14.4478 7.53782 14.1705 6.87141 13.6787 6.37961C13.1869 5.8878 12.5205 5.61053 11.825 5.60833H4.32501V4.9C4.32499 3.8766 4.72981 2.89475 5.45112 2.16876C6.17242 1.44277 7.15163 1.0316 8.17501 1.025H15.0417C16.0694 1.025 17.055 1.43326 17.7817 2.15996C18.5084 2.88667 18.9167 3.87229 18.9167 4.9V9.9C18.9145 10.9191 18.511 11.8963 17.7936 12.62C17.0761 13.3438 16.1024 13.7557 15.0833 13.7667L14.45 13.7333ZM11.825 4.35833C12.8527 4.35833 13.8383 4.76659 14.565 5.4933C15.2918 6.22 15.7 7.20562 15.7 8.23333V12.4C16.2563 12.256 16.7499 11.9334 17.1051 11.4818C17.4604 11.0302 17.6577 10.4745 17.6667 9.9V4.9C17.6645 4.20448 17.3872 3.53808 16.8954 3.04627C16.4036 2.55447 15.7372 2.2772 15.0417 2.275H8.17501C7.57162 2.27426 6.98652 2.48208 6.51878 2.86325C6.05104 3.24443 5.72941 3.77555 5.60834 4.36667L11.825 4.35833ZM8.39168 18.975C8.11942 18.9763 7.85098 18.911 7.60983 18.7846C7.36868 18.6582 7.16217 18.4746 7.00834 18.25L6.25834 17.1917C6.23236 17.1517 6.19642 17.1191 6.15405 17.0972C6.11168 17.0753 6.06434 17.0648 6.01668 17.0667H5.00001C4.48764 17.0722 3.97927 16.976 3.50431 16.7837C3.02936 16.5915 2.59725 16.3069 2.233 15.9465C1.86874 15.5862 1.57958 15.1571 1.38224 14.6843C1.18491 14.2114 1.08331 13.7041 1.08334 13.1917V8.23333C1.08331 7.72094 1.18491 7.21362 1.38224 6.74075C1.57958 6.26788 1.86874 5.83884 2.233 5.47846C2.59725 5.11808 3.02936 4.83352 3.50431 4.64126C3.97927 4.44899 4.48764 4.35283 5.00001 4.35833H11.8667C12.8944 4.35833 13.88 4.76659 14.6067 5.4933C15.3334 6.22 15.7417 7.20562 15.7417 8.23333V13.1917C15.7417 14.2194 15.3334 15.205 14.6067 15.9317C13.88 16.6584 12.8944 17.0667 11.8667 17.0667H10.7667C10.7191 17.0656 10.6721 17.0764 10.6299 17.0983C10.5876 17.1201 10.5516 17.1522 10.525 17.1917L9.77501 18.25C9.62119 18.4746 9.41467 18.6582 9.17352 18.7846C8.93237 18.911 8.66393 18.9763 8.39168 18.975V18.975ZM5.00001 5.60833C4.6521 5.60393 4.30677 5.66851 3.98397 5.79835C3.66116 5.9282 3.36729 6.12072 3.11934 6.36481C2.87138 6.60889 2.67425 6.89969 2.53934 7.22041C2.40443 7.54113 2.33442 7.8854 2.33334 8.23333V13.1917C2.33108 13.5413 2.39869 13.8879 2.53222 14.2111C2.66574 14.5342 2.86249 14.8275 3.1109 15.0735C3.35931 15.3196 3.65438 15.5136 3.97878 15.6441C4.30319 15.7745 4.65039 15.8389 5.00001 15.8333H6.01668C6.26537 15.8321 6.51063 15.8914 6.7313 16.0061C6.95197 16.1208 7.14143 16.2874 7.28334 16.4917L8.02501 17.5C8.06634 17.559 8.12121 17.6071 8.18501 17.6405C8.24881 17.6738 8.31968 17.6914 8.39168 17.6917V17.6917C8.46367 17.6914 8.53454 17.6738 8.59834 17.6405C8.66215 17.6071 8.71701 17.559 8.75834 17.5L9.50001 16.4417C9.64737 16.2466 9.83922 16.0897 10.0596 15.9839C10.2799 15.878 10.5223 15.8264 10.7667 15.8333H11.825C12.5212 15.8333 13.1889 15.5568 13.6812 15.0645C14.1734 14.5722 14.45 13.9045 14.45 13.2083V8.23333C14.4478 7.53782 14.1705 6.87141 13.6787 6.37961C13.1869 5.8878 12.5205 5.61053 11.825 5.60833H5.00001ZM5.48334 10C5.32841 10 5.17697 10.0459 5.04815 10.132C4.91933 10.2181 4.81893 10.3404 4.75964 10.4836C4.70035 10.6267 4.68484 10.7842 4.71506 10.9362C4.74529 11.0881 4.81989 11.2277 4.92944 11.3372C5.03899 11.4468 5.17857 11.5214 5.33052 11.5516C5.48247 11.5818 5.63998 11.5663 5.78311 11.507C5.92625 11.4478 6.04859 11.3474 6.13466 11.2185C6.22074 11.0897 6.26668 10.9383 6.26668 10.7833C6.26451 10.5763 6.18128 10.3783 6.03485 10.2318C5.88841 10.0854 5.69042 10.0022 5.48334 10ZM8.40001 10C8.2466 9.99705 8.09571 10.0392 7.96606 10.1213C7.83641 10.2033 7.7337 10.3216 7.6707 10.4615C7.6077 10.6014 7.58717 10.7568 7.61166 10.9082C7.63615 11.0597 7.70459 11.2006 7.80847 11.3136C7.91235 11.4265 8.04711 11.5064 8.19601 11.5434C8.34492 11.5804 8.50141 11.5729 8.64607 11.5217C8.79073 11.4706 8.91718 11.3781 9.00973 11.2557C9.10228 11.1333 9.15685 10.9865 9.16668 10.8333C9.17228 10.728 9.15677 10.6226 9.12106 10.5233C9.08535 10.4241 9.03016 10.3329 8.95874 10.2553C8.88731 10.1777 8.8011 10.1151 8.70515 10.0713C8.6092 10.0274 8.50545 10.0032 8.40001 10V10ZM11.3083 10C11.1534 10 11.002 10.0459 10.8731 10.132C10.7443 10.2181 10.6439 10.3404 10.5846 10.4836C10.5253 10.6267 10.5098 10.7842 10.5401 10.9362C10.5703 11.0881 10.6449 11.2277 10.7544 11.3372C10.864 11.4468 11.0036 11.5214 11.1555 11.5516C11.3075 11.5818 11.465 11.5663 11.6081 11.507C11.7512 11.4478 11.8736 11.3474 11.9597 11.2185C12.0457 11.0897 12.0917 10.9383 12.0917 10.7833C12.0895 10.5763 12.0063 10.3783 11.8598 10.2318C11.7134 10.0854 11.5154 10.0022 11.3083 10V10Z"
              fill="#7E8299"
            />
          </svg>
          <span>{{ commentsAmount }}</span>
        </div>
      </div>
      <h2 class="text-2xl font-semibold">{{ props.post.title }}</h2>
    </div>
    <p v-if="!modal" class="font-medium">
      {{ props.post.description }}
    </p>
    <p v-else class="text-xl font-medium">
      {{ props.post.text }}
    </p>
    <div class="flex flex-row gap-2.5">
      <chip-component
        v-for="chip in props.post.tags"
        :key="chip"
        :chip="chip"
      ></chip-component>
    </div>

    <!-- Comments and Controls -->
    <div v-if="modal" class="flex flex-col gap-2.5">
      <div class="flex flex-row gap-1.5">
        <h2 class="font-semibold">Комментариев</h2>
        <span class="font-medium text-text-secondary">{{
          props.post.comments.length
        }}</span>
      </div>
      <div class="flex flex-col gap-1.5">
        <textarea
          v-model="comment"
          :class="`w-full transition-all placeholder-gray-400 h-11 lg:h-32 resize-none rounded-md p-3 outline outline-gray-200 outline-1 font-medium ${
            comment.length > 250
              ? ' outline-error focus:outline-error'
              : 'focus:outline-primary'
          }`"
          placeholder="Введите комментарий"
          type="text"
        />
        <div class="flex flex-row">
          <span class="text-text-secondary text-[0.75rem]">
            <span :class="isCommentLengthOverLimit ? 'text-error' : ''">
              {{ comment.length }}</span
            >
            из 250 символов
          </span>
        </div>
      </div>

      <!-- Controls -->

      <div class="flex flex-row h-10 self-end gap-2.5 text-[0.813rem]">
        <button
          class="font-bold w-[7.5rem] rounded-md text-primary bg-primary-light"
          @click="handleCancelClick"
        >
          Отмена
        </button>
        <button
          :class="`transition font-semibold w-[7.5rem] rounded-md ${
            !isPublishButtonClickable
              ? 'text-slate-50 bg-blue-200'
              : 'text-primary-light bg-primary'
          }`"
          :disabled="!isPublishButtonClickable"
          @click="handlePublishClick"
        >
          Опубликовать
        </button>
      </div>

      <!-- Comments -->

      <div v-if="props.post.comments.length">
        <comment-component
          v-for="comment in sortedComments"
          :key="comment.date"
          :comment="comment"
        ></comment-component>
      </div>
    </div>
  </div>
</template>

<script setup lang="ts">
import ChipComponent from "./ChipComponent.vue";
import CommentComponent from "./CommentComponent.vue";

import { computed, ref } from "vue";

import { useStore } from "vuex";

const store = useStore();

const props = defineProps({
  post: {
    type: Object,
    required: true,
  },
  clickable: {
    type: Boolean,
    default: false,
  },
  modal: {
    type: Boolean,
    default: false,
  },
});

const comment = ref("");

const handleImageClick = () => {
  store.commit("SET_PICKED_POST", props.post);
};

const handleCancelClick = () => {
  comment.value = "";
};

const handlePublishClick = () => {
  store.commit("ADD_COMMENT_TO_POST", {
    authorId: Math.random(),
    authorName: "Test User",
    date: new Date(Date.now()),
    text: comment.value,
  });
  comment.value = "";
};

const handleExitClick = () => {
  store.commit("SET_PICKED_POST", {});
};

const isCommentLengthOverLimit = computed(() => {
  return comment.value.length > 250;
});

const isPublishButtonClickable = computed(() => {
  return comment.value.length > 0 && !isCommentLengthOverLimit.value;
});

const sortedComments = computed(() => {
  return props.post.comments.sort(
    (a: { date: Date }, b: { date: Date }) =>
      b.date.getTime() - a.date.getTime()
  );
});
// GPT-coding >:) *lazy to do it by myself, also time-consuming..*

const commentsAmount = computed(() => {
  const count = props.post.comments.length;
  const lastDigit = count % 10;
  const lastTwoDigits = count % 100;

  if (lastDigit === 1 && lastTwoDigits !== 11) {
    return `${count} комментарий`;
  } else if (
    lastDigit >= 2 &&
    lastDigit <= 4 &&
    (lastTwoDigits < 12 || lastTwoDigits > 14)
  ) {
    return `${count} комментария`;
  } else {
    return `${count} комментариев`;
  }
});

const formattedDate = computed(() => {
  const options = { day: "numeric", month: "short" };
  return props.post.date.toLocaleDateString("ru-RU", options).replace(".", "");
});
</script>

<style scoped></style>
